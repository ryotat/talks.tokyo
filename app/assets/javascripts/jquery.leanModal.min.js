// leanModal v1.1 by Ray Stone - http://finelysliced.com.au
// Dual licensed under the MIT and GPL

(function($){$.fn.extend({
    leanModal:function(options){
	var defaults={top:100,overlay:0.5,closeButton:null};var overlay=$("<div id='lean_overlay'></div>");if($('#lean_overlay').length==0){$("body").append(overlay);}options=$.extend(defaults,options);
	return this.each(function(){
	    $(this).click(function(e){
		var modal_id=$(this).attr("href");
		$(modal_id).leanModalShow(options);
		e.preventDefault()});}); },
    leanModalShow:function(options){
	var defaults={top:100,overlay:0.5,closeButton:null};
	var overlay=$("<div id='lean_overlay'></div>");
	if($('#lean_overlay').length==0) {
	    $("body").append(overlay);
	}
	options=$.extend(defaults,options);
	return this.each(function(){
	    var o=options;
	    var modal=$(this);
	    $("#lean_overlay").click(function(){modal.leanModalClose();});
	    $(o.closeButton).live('click',function(){modal.leanModalClose();});
	    $(document).keyup(function(e){if(e.which==27){modal.leanModalClose();}});
	    var modal_height=modal.outerHeight();
	    var modal_width=modal.outerWidth();
	    var modal_prop=modal_width/$(window).width();
	    $("#lean_overlay").css({"display":"block",opacity:0});
	    $("#lean_overlay").fadeTo(200,o.overlay);
	    modal.css({"display":"block","position":"absolute","opacity":0,"z-index":11000,"left":0,"margin-left":(1-modal_prop)*50+"%","top":o.top+"px"});
	    modal.fadeTo(200,1);
	});
    },
    leanModalClose: function (){
	$("#lean_overlay").fadeOut(200);$(this).css({"display":"none"})
    }
});
})(jQuery);